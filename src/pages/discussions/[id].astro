---
import BaseLayout from "../../layouts/BaseLayout.astro";
import Discussion from "../../layouts/discussion/Discussion.astro";
import { config } from "../../config";

interface DiscussionTopic {
  id: number;
  date: string;
  user: string;
  title: string;
  tags: string;
  description: string;
}

const response: Response = await fetch(`${config.apiRoot}/Discussion`);
const topics: DiscussionTopic[] = await response.json();

topics.map((topic) => ({
  params: { id: topic.id },
}));

const { id } = Astro.params;
const curr_topic = topics.find((curr_topic) => String(curr_topic.id) === id!);
if (!curr_topic) return Astro.redirect("/404");



---

<BaseLayout title={`Discussion #${id}`}>
  <Discussion {...curr_topic} />
</BaseLayout>
